<section
  class="min-h-screen flex items-center justify-center
         bg-gradient-to-br from-blue-50 to-indigo-100 px-4"
>

  <div
    class="w-full max-w-md bg-white
           rounded-xl shadow-lg p-8
           transition-all duration-300"
  >

    <!-- TITLE -->
    <h2 class="text-2xl font-bold text-gray-800 text-center mb-4">
      {{
        step === 'EMAIL' ? 'Forgot Password'
        : step === 'OTP' ? 'Verify OTP'
        : step === 'RESET' ? 'Reset Password'
        : 'Success'
      }}
    </h2>

    <!-- DESCRIPTION -->
    <p class="text-sm text-gray-600 text-center mb-6">
      {{
        step === 'EMAIL'
          ? 'Enter your registered email to receive an OTP'
          : step === 'OTP'
          ? 'Enter the 6-digit OTP sent to your email'
          : step === 'RESET'
          ? 'Create a new password'
          : 'Your password has been reset successfully'
      }}
    </p>

    <!-- STEP 1: EMAIL -->
    <div *ngIf="step === 'EMAIL'">

      <input
        #email
        type="email"
        placeholder="you@example.com"
        class="w-full h-11 px-3 mb-6 rounded-md border
               focus:ring-2 focus:ring-blue-500"
      />

      <button
        (click)="sendOtp(email.value)"
        [disabled]="loading"
        class="w-full h-11 bg-blue-600 text-white
               font-semibold rounded-md
               hover:bg-blue-700 transition
               disabled:bg-gray-300"
      >
        {{ loading ? 'Sending OTP...' : 'Send OTP' }}
      </button>

    </div>

    <!-- STEP 2: OTP -->
    <div *ngIf="step === 'OTP'">

      <!-- OTP INPUTS -->
      <div class="flex justify-between mb-4">
        <input
          *ngFor="let i of otpBoxes; let idx = index"
          maxlength="1"
          (keydown)="handleOtpKey($event, idx)"
          (input)="handleOtpInput($event, idx)"
          class="w-10 h-11 text-center text-lg font-semibold
                 border rounded-md
                 focus:ring-2 focus:ring-blue-500"
        />
      </div>

      <!-- TIMER -->
      <p class="text-sm text-gray-500 text-center mb-4">
        OTP expires in
        <span class="font-semibold text-blue-600">
          {{ countdown }}s
        </span>
      </p>

      <button
        (click)="verifyOtp()"
        [disabled]="loading"
        class="w-full h-11 bg-green-600 text-white
               font-semibold rounded-md
               hover:bg-green-700 transition"
      >
        {{ loading ? 'Verifying...' : 'Verify OTP' }}
      </button>

      <button
        *ngIf="countdown === 0"
        (click)="resendOtp()"
        class="mt-4 block mx-auto text-sm
               text-blue-600 hover:underline"
      >
        Resend OTP
      </button>

    </div>

    <!-- STEP 3: RESET PASSWORD -->
    <div *ngIf="step === 'RESET'">

      <input
        type="password"
        placeholder="New Password"
        [(ngModel)]="newPassword"
        class="w-full h-11 px-3 mb-4 rounded-md border
               focus:ring-2 focus:ring-blue-500"
      />

      <input
        type="password"
        placeholder="Confirm Password"
        [(ngModel)]="confirmPassword"
        class="w-full h-11 px-3 mb-6 rounded-md border
               focus:ring-2 focus:ring-blue-500"
      />

      <button
        (click)="resetPassword()"
        [disabled]="loading"
        class="w-full h-11 bg-blue-600 text-white
               font-semibold rounded-md
               hover:bg-blue-700 transition"
      >
        {{ loading ? 'Updating...' : 'Reset Password' }}
      </button>

    </div>

    <!-- STEP 4: SUCCESS -->
    <div *ngIf="step === 'SUCCESS'" class="text-center">

      <div
        class="mx-auto mb-4 h-12 w-12
               rounded-full bg-green-100
               flex items-center justify-center
               animate-bounce"
      >
        âœ“
      </div>

      <p class="text-green-600 font-semibold">
        Password reset successfully
      </p>

      <p class="mt-2 text-sm text-gray-500">
        Redirecting to login...
      </p>

    </div>

    <!-- ERROR -->
    <p *ngIf="error" class="mt-4 text-sm text-red-600 text-center">
      {{ error }}
    </p>

    <!-- BACK -->
    <a
      routerLink="/auth/login"
      *ngIf="step !== 'SUCCESS'"
      class="block mt-6 text-center text-sm text-gray-600 hover:underline"
    >
      Back to Login
    </a>

  </div>

</section>
