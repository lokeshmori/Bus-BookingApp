<section class="space-y-6">

  <!-- HEADER -->
  <div class="flex justify-between items-center">
    <div>
      <h2 class="text-2xl font-bold text-gray-800">
        Seat Layout Designer
      </h2>
      <p class="text-sm text-gray-500">
        Design and validate bus seat layouts
      </p>
    </div>

    <!-- DECK TOGGLE -->
    <div class="flex items-center gap-2">
      <button
        (click)="deck = 'LOWER'"
        [class.bg-blue-600]="deck === 'LOWER'"
        class="px-4 py-2 rounded-md
               border text-sm
               hover:bg-blue-50"
      >
        Lower Deck
      </button>

      <button
        (click)="deck = 'UPPER'"
        [class.bg-blue-600]="deck === 'UPPER'"
        class="px-4 py-2 rounded-md
               border text-sm
               hover:bg-blue-50"
      >
        Upper Deck
      </button>
    </div>
  </div>

  <!-- DRIVER SIDE -->
  <div class="flex items-center gap-4 text-sm">
    <span class="font-medium text-gray-700">
      Driver Side:
    </span>

    <label class="flex items-center gap-2">
      <input
        type="radio"
        name="driver"
        value="LEFT"
        [(ngModel)]="driverSide"
      />
      Left-hand Drive
    </label>

    <label class="flex items-center gap-2">
      <input
        type="radio"
        name="driver"
        value="RIGHT"
        [(ngModel)]="driverSide"
      />
      Right-hand Drive
    </label>
  </div>

  <!-- LEGEND -->
  <div class="flex flex-wrap gap-6 text-sm">
    <div class="flex items-center gap-2">
      <span class="h-4 w-4 bg-green-500 rounded"></span>
      Normal Seat
    </div>
    <div class="flex items-center gap-2">
      <span class="h-4 w-4 bg-pink-500 rounded"></span>
      Ladies Seat
    </div>
    <div class="flex items-center gap-2">
      <span class="h-4 w-4 bg-gray-200 border rounded"></span>
      Empty Cell
    </div>
  </div>

  <!-- GRID WRAPPER -->
  <div class="bg-white rounded-lg shadow p-4 overflow-auto">

    <div class="flex gap-4">

      <!-- ROW LABELS -->
      <div class="flex flex-col gap-2 pt-8">
        <div
          *ngFor="let r of [].constructor(rows); let row = index"
          class="h-12 flex items-center justify-center
                 font-semibold text-gray-600"
        >
          {{ getRowLabel(row) }}
        </div>
      </div>

      <!-- GRID -->
      <div
        class="grid gap-2"
        [style.gridTemplateColumns]="'repeat(' + cols + ', 3rem)'"
      >

        <ng-container *ngFor="let r of [].constructor(rows); let row = index">
          <ng-container *ngFor="let c of [].constructor(cols); let col = index">

            <!-- CELL -->
            <div
              (click)="addSeat(row, col)"
              class="h-12 w-12 border border-dashed
                     rounded-md flex items-center
                     justify-center cursor-pointer
                     hover:bg-blue-50 transition"
            >

              <!-- SEAT -->
              <div
                *ngIf="getSeatAt(row, col) as seat"
                cdkDrag
                (dblclick)="removeSeat(seat.id)"
                class="relative h-10 w-10
                       flex items-center justify-center
                       rounded-md text-xs
                       font-semibold text-white
                       cursor-move shadow select-none"
                [ngClass]="seat.ladies
                  ? 'bg-pink-500'
                  : 'bg-green-500'"
              >

                {{ seat.label }}

                <!-- PRICE BADGE -->
                <span
                  class="absolute -top-2 -right-2
                         bg-black text-white
                         text-[10px] px-1.5 py-0.5
                         rounded-full"
                >
                  â‚¹{{ seat.price }}
                </span>

              </div>

            </div>

          </ng-container>
        </ng-container>

      </div>

    </div>
  </div>

  <!-- VALIDATION WARNINGS -->
  <div *ngIf="validationErrors.length"
       class="bg-red-50 border border-red-200
              text-red-700 rounded-md p-4">
    <p class="font-semibold mb-1">Validation Issues:</p>
    <ul class="list-disc pl-5 text-sm">
      <li *ngFor="let err of validationErrors()">
        {{ err }}
      </li>
    </ul>
  </div>

  <!-- ACTIONS -->
  <div class="flex justify-end gap-4">
    <button
      (click)="previewLayout()"
      class="px-5 py-2 border
             rounded-md hover:bg-gray-50"
    >
      Preview
    </button>

    <button
      (click)="saveLayout()"
      [disabled]="validationErrors().length"
      class="px-6 py-2 bg-blue-600
             text-white font-semibold
             rounded-md hover:bg-blue-700
             disabled:bg-gray-300"
    >
      Save Layout
    </button>
  </div>

</section>
